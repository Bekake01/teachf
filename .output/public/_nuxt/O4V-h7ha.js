import{f as V,ap as D,G as p,H as A,c as r,a as e,b as d,n as S,w as v,z as o,t as u,F as _,x as w,Y as K,y as R,aq as E,o as a,d as H,X as L,s as O,v as $,m as G,ar as X,_ as Y}from"./CoOn5R3x.js";import{$ as J,a as M}from"./CWO2-Qi6.js";const P={class:"min-h-screen bg-gray-50 dark:bg-gray-900 py-4"},Q={class:"max-w-7xl mx-auto px-4"},W={class:"mb-6"},Z={class:"flex items-center justify-between flex-wrap gap-4"},ee={key:0,class:"flex items-center gap-2 px-4 py-2 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700"},te={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},se={key:0,class:"flex justify-center items-center py-20"},ae={key:1,class:"text-center py-20"},re={class:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-red-100 dark:bg-red-900/30 mb-4"},ne={class:"text-red-600 dark:text-red-400 mb-4 text-sm sm:text-base"},oe={key:2,class:"text-center py-20"},de={class:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-gray-100 dark:bg-gray-800 mb-4"},ie={key:3,class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden"},le={class:"overflow-x-auto"},ce={class:"w-full min-w-max"},ge={class:"bg-gray-50 dark:bg-gray-900/50 border-b border-gray-200 dark:border-gray-700"},xe={class:"flex flex-col items-center"},ue={class:"text-lg font-bold"},ye={key:0,class:"w-2 h-2 bg-red-500 rounded-full mt-1"},me={class:"divide-y divide-gray-200 dark:divide-gray-700"},_e={class:"sticky left-0 z-10 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-900/30 px-3 sm:px-4 py-3 border-r border-gray-200 dark:border-gray-700"},fe={class:"flex items-center gap-2"},pe={class:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 flex-shrink-0"},be={class:"text-xs sm:text-sm font-medium text-gray-900 dark:text-gray-100 whitespace-nowrap"},he={class:"flex justify-center items-center"},ke={key:1},ve={key:2,class:"p-1"},we={key:3,class:"text-gray-400 dark:text-gray-600 text-xs"},$e={key:1,class:"p-1"},je={class:"border-t border-gray-200 dark:border-gray-700 px-4 py-3 bg-gray-50 dark:bg-gray-900/50"},Ne={class:"flex flex-wrap items-center gap-4 text-xs sm:text-sm"},Ce={class:"flex items-center gap-2"},De={class:"w-6 h-6 rounded-lg bg-green-100 dark:bg-green-900/40 flex items-center justify-center"},Se={class:"flex items-center gap-2"},Me={class:"w-6 h-6 rounded-lg bg-amber-100 dark:bg-amber-900/40 flex items-center justify-center"},Ue={class:"flex items-center gap-2"},qe={class:"w-6 h-6 rounded-lg bg-red-100 dark:bg-red-900/40 flex items-center justify-center"},ze={class:"space-y-4"},Be={key:0,class:"space-y-2"},Fe={class:"p-3 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm sm:text-base"},Ie={key:1,class:"text-center text-gray-500 dark:text-gray-400"},Te=V({__name:"hist",setup(Ve){const j=D("selectedFanId",()=>null),y=D("selectedDateRange",()=>null),g=p({students:[],days:[]}),b=p(!0),f=p(null),x=p({open:!1,title:"",existingNote:""}),N=new J("en-US",{dateStyle:"medium"});function C(){if(!y.value)return"";const s=y.value.start,t=y.value.end;return s&&t?`${N.format(s.toDate(M()))} - ${N.format(t.toDate(M()))}`:""}function h(s,t){return s.attendance?.find(i=>i.dvid===t)||null}function m(s,t){return h(s,t)?.status||null}function U(s,t){const i=h(s,t);return i?.note&&i.note.trim()?i.note:null}function q(s){switch(s){case"present":return"vaadin:check";case"late":return"ep:warning-filled";case"absent":return"fa:remove";default:return"ep:question-filled"}}function z(s){switch(s){case"present":return"text-green-500 text-xl";case"late":return"text-yellow-500 text-xl";case"absent":return"text-red-500 text-xl";default:return"text-gray-500 text-xl"}}function B(s,t){const i=h(s,t),l=g.value.days.find(k=>k.id===t);x.value={open:!0,title:`${s.ism} - ${l?.day}-kun`,existingNote:i?.note||""}}async function F(){try{b.value=!0,f.value=null;const s={jid:j.value?.jid,fl:j.value?.fl,start:y.value?.start,end:y.value?.end},t=await K.post("/jadval/gethistory-student",s);g.value=t.data||{students:[],days:[]},console.log("History data:",g.value)}catch(s){f.value="Ma'lumotlarni yuklashda xatolik",console.error(s)}finally{b.value=!1}}return A(()=>{F()}),(s,t)=>{const i=R,l=O,k=X,I=E;return a(),r(_,null,[e("div",P,[e("div",Q,[e("div",W,[e("div",Z,[d(i,{icon:"i-lucide-arrow-left",color:"neutral",variant:"subtle",onClick:t[0]||(t[0]=n=>("navigateTo"in s?s.navigateTo:o(L))("/davomat"))},{default:v(()=>[...t[2]||(t[2]=[H(" Orqaga ",-1)])]),_:1}),C()?(a(),r("div",ee,[d(l,{name:"i-heroicons-calendar",class:"w-5 h-5 text-gray-500 dark:text-gray-400"}),e("span",te,u(C()),1)])):S("",!0)])]),o(b)?(a(),r("div",se,[d(l,{name:"i-heroicons-arrow-path",class:"w-8 h-8 animate-spin text-blue-500 dark:text-blue-400"})])):o(f)?(a(),r("div",ae,[e("div",re,[d(l,{name:"i-heroicons-exclamation-circle",class:"w-8 h-8 text-red-600 dark:text-red-400"})]),e("p",ne,u(o(f)),1)])):!o(g).students||o(g).students.length===0?(a(),r("div",oe,[e("div",de,[d(l,{name:"i-heroicons-users",class:"w-8 h-8 text-gray-400 dark:text-gray-500"})]),t[3]||(t[3]=e("p",{class:"text-gray-500 dark:text-gray-400 text-base sm:text-lg"},"Ma'lumot topilmadi",-1))])):(a(),r("div",ie,[e("div",le,[e("table",ce,[e("thead",ge,[e("tr",null,[t[4]||(t[4]=e("th",{class:"sticky left-0 z-10 bg-gray-50 dark:bg-gray-900/50 px-3 sm:px-4 py-3 text-left text-xs sm:text-sm font-semibold text-gray-900 dark:text-gray-100 border-r border-gray-200 dark:border-gray-700"}," O'quvchi ",-1)),(a(!0),r(_,null,w(o(g).days,n=>(a(),r("th",{key:n.id,class:$(["px-3 sm:px-4 py-3 text-center text-xs sm:text-sm font-semibold text-gray-900 dark:text-gray-100 whitespace-nowrap",{"bg-red-100 dark:bg-red-900/30":!n.isdone}])},[e("div",xe,[e("span",ue,u(n.day),1),n.isdone?S("",!0):(a(),r("div",ye))])],2))),128))])]),e("tbody",me,[(a(!0),r(_,null,w(o(g).students,(n,T)=>(a(),r("tr",{key:n.stid,class:"hover:bg-gray-50 dark:hover:bg-gray-900/30 transition-colors"},[e("td",_e,[e("div",fe,[e("span",pe,u(T+1)+". ",1),e("span",be,u(n.ism),1)])]),(a(!0),r(_,null,w(o(g).days,c=>(a(),r("td",{key:c.id,class:$(["px-3 sm:px-4 py-3 text-center",{"bg-red-50 dark:bg-red-900/20":!c.isdone}])},[e("div",he,[c.isdone?(a(),r(_,{key:0},[m(n,c.id)==="absent"&&U(n,c.id)?(a(),G(k,{key:0},{default:v(()=>[d(i,{onClick:Ae=>B(n,c.id),color:"error",variant:"ghost",size:"sm",icon:"fa:remove"},null,8,["onClick"])]),_:2},1024)):m(n,c.id)==="absent"?(a(),r("div",ke,[d(l,{name:"fa:remove",class:"text-red-500 text-xl"})])):m(n,c.id)?(a(),r("div",ve,[d(l,{name:q(m(n,c.id)),class:$(z(m(n,c.id)))},null,8,["name","class"])])):(a(),r("span",we,"-"))],64)):(a(),r("div",$e))])],2))),128))]))),128))])])]),e("div",je,[e("div",Ne,[e("div",Ce,[e("div",De,[d(l,{name:"i-heroicons-check",class:"w-4 h-4 text-green-600 dark:text-green-400"})]),t[5]||(t[5]=e("span",{class:"text-gray-700 dark:text-gray-300"},"Keldi",-1))]),e("div",Se,[e("div",Me,[d(l,{name:"i-heroicons-exclamation-triangle",class:"w-4 h-4 text-amber-600 dark:text-amber-400"})]),t[6]||(t[6]=e("span",{class:"text-gray-700 dark:text-gray-300"},"Kech",-1))]),e("div",Ue,[e("div",qe,[d(l,{name:"i-heroicons-x-mark",class:"w-4 h-4 text-red-600 dark:text-red-400"})]),t[7]||(t[7]=e("span",{class:"text-gray-700 dark:text-gray-300"},"Kelmadi",-1))])])])]))])]),d(I,{open:o(x).open,"onUpdate:open":t[1]||(t[1]=n=>o(x).open=n),title:o(x).title},{body:v(()=>[e("div",ze,[o(x).existingNote?(a(),r("div",Be,[e("div",Fe,u(o(x).existingNote),1)])):(a(),r("div",Ie," Eslatma yo'q "))])]),_:1},8,["open","title"])],64)}}}),Ee=Y(Te,[["__scopeId","data-v-a7dc8a16"]]);export{Ee as default};
